loans <- read.csv('loan_data.csv',stringsAsFactors = TRUE)
loans$inq.last.6mths <- as.factor(loans$inq.last.6mths)
loans$delinq.2yrs <- as.factor(loans$delinq.2yrs)
loans$pub.rec <- as.factor(loans$pub.rec)
loans$not.fully.paid <- as.factor(loans$not.fully.paid)
loans$credit.policy <- as.factor(loans$credit.policy)
## Creating the model
install.packages("e1071")
library(e1071)
install.packages("caTools")
library(caTools)
set.seed(101)
spl <- sample.split(loans$not.fully.paid, SplitRatio = 0.7)
loans.train <- subset(loans, spl == TRUE)
loans.test <- subset(loans, spl == FALSE)
# Model
svm.model <- svm(not.fully.paid ~. , loans.train)
summary(svm.model)
prediction <- predict(svm.model, loans.test[1:13])
table(prediction, loans.test$not.fully.paid)
# Using tune
svm.model$gamma
tune.results <- tune(svm,train.x=not.fully.paid~., data=loans.train,kernel='radial', ranges=list(cost=c(1,10), gamma=c(0.1, 1)))
loans <- read.csv('loan_data.csv',stringsAsFactors = TRUE)
loans$inq.last.6mths <- as.factor(loans$inq.last.6mths)
loans$delinq.2yrs <- as.factor(loans$delinq.2yrs)
loans$pub.rec <- as.factor(loans$pub.rec)
loans$not.fully.paid <- as.factor(loans$not.fully.paid)
loans$credit.policy <- as.factor(loans$credit.policy)
## Creating the model
install.packages("e1071")
library(e1071)
install.packages("caTools")
library(caTools)
set.seed(101)
spl <- sample.split(loans$not.fully.paid, SplitRatio = 0.7)
loans.train <- subset(loans, spl == TRUE)
loans.test <- subset(loans, spl == FALSE)
# Model
svm.model <- svm(not.fully.paid ~. , loans.train)
summary(svm.model)
prediction <- predict(svm.model, loans.test[1:13])
table(prediction, loans.test$not.fully.paid)
# Using tune
svm.model$gamma
tune.results <- tune(svm,train.x=not.fully.paid~., data=loans.train,kernel='radial', ranges=list(cost=c(1,10), gamma=c(0.1, 1)))
tune.results <- tune(svm,train.x=not.fully.paid~., data=loans.train,kernel='radial', ranges=list(cost=c(100,200), gamma=c(0.1)))
summary(tune.results)
pred.tuned <- svm(svm.model, loans.test[1:13], cost = 100, gamma = 0.1)
pred.tuned <- predict(svm.model, loans.test[1:13], cost = 100, gamma = 0.1)
table(pred.tuned, loans.test$not.fully.paid)
pred.tuned <- smv(not.fully.paid ~., loans.train, cost = 100, gamma = 0.1)
library(e1071)
pred.tuned <- smv(not.fully.paid ~., loans.train, cost = 100, gamma = 0.1)
## Creating the model
install.packages("e1071")
install.packages("e1071")
library(e1071)
tuned.model <- smv(not.fully.paid ~., loans.train, cost = 100, gamma = 0.1)
tuned.model <- svm(not.fully.paid ~., loans.train, cost = 100, gamma = 0.1)
pred.tuned <- predict(tuned.model, loans.test)
table(pred.tuned, loans.test$not.fully.paid)
